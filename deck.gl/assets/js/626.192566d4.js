"use strict";(self.webpackChunkproject_website=self.webpackChunkproject_website||[]).push([[626],{20626:(t,e,i)=>{i.d(e,{y:()=>jn});var n=i(92214),r=i(52027);function s(t,e){if(!t)throw new Error("null row");const i={};if(e)for(let n=0;n<e.length;n++)i[e[n]]=t[n];else for(let n=0;n<t.length;n++){i[`column-${n}`]=t[n]}return i}function o(t,e){if(!t)throw new Error("null row");if(e){const i=new Array(e.length);for(let n=0;n<e.length;n++)i[n]=t[e[n]];return i}return Object.values(t)}var a=i(6537);function l(t){switch(t.shape){case"array-row-table":case"object-row-table":return c(t.data);case"geojson-table":return function(t){if(!t.length)throw new Error("deduce from empty table");const e=[],i=t[0].properties||{};for(const[n,r]of Object.entries(i))e.push(p(r,n));return{fields:e,metadata:{}}}(t.features);case"columnar-table":return u(t.data);default:throw new Error("Deduce schema")}}function u(t){const e=[];for(const[i,n]of Object.entries(t)){const t=h(n,i);e.push(t)}return{fields:e,metadata:{}}}function c(t){if(!t.length)throw new Error("deduce from empty table");const e=[],i=t[0];for(const[n,r]of Object.entries(i))e.push(p(r,n));return{fields:e,metadata:{}}}function h(t,e){if(ArrayBuffer.isView(t)){const i=(0,a.IT)(t);return{name:e,type:i.type||"null",nullable:i.nullable}}if(Array.isArray(t)&&t.length>0){const i=t[0];return{name:e,type:(0,a.k1)(i),nullable:!0}}throw new Error("empty table")}function p(t,e){return{name:e,type:(0,a.k1)(t),nullable:!0}}class y extends Array{enqueue(t){return this.push(t)}dequeue(){return this.shift()}}class d{_values;_settlers;_closed;constructor(){this._values=new y,this._settlers=new y,this._closed=!1}close(){for(;this._settlers.length>0;)this._settlers.dequeue().resolve({done:!0});this._closed=!0}[Symbol.asyncIterator](){return this}enqueue(t){if(this._closed)throw new Error("Closed");if(this._settlers.length>0){if(this._values.length>0)throw new Error("Illegal internal state");const e=this._settlers.dequeue();t instanceof Error?e.reject(t):e.resolve({value:t})}else this._values.enqueue(t)}next(){if(this._values.length>0){const t=this._values.dequeue();return t instanceof Error?Promise.reject(t):Promise.resolve({value:t})}if(this._closed){if(this._settlers.length>0)throw new Error("Illegal internal state");return Promise.resolve({done:!0})}return new Promise(((t,e)=>{this._settlers.enqueue({resolve:t,reject:e})}))}}class f{schema;options;shape;length=0;rows=null;cursor=0;_headers=[];constructor(t,e){if(this.options=e,this.schema=t,!Array.isArray(t)){this._headers=[];for(const e in t)this._headers[t[e].index]=t[e].name}}rowCount(){return this.length}addArrayRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="array-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}addObjectRow(t,e){Number.isFinite(e)&&(this.cursor=e),this.shape="object-row-table",this.rows=this.rows||new Array(100),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;if(!t)return null;t=t.slice(0,this.length),this.rows=null;return{shape:this.shape||"array-row-table",batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}}}class g{schema;options;length=0;objectRows=null;arrayRows=null;cursor=0;_headers=null;constructor(t,e){if(this.options=e,this.schema=t,t){this._headers=[];for(let e=0;e<t.fields.length;e++)this._headers[e]=t.fields[e].name}}rowCount(){return this.length}addArrayRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){const e=[];for(let i=0;i<t.length;i++){const t=`column-${i}`;e.push(t)}return e}(t),this.options.shape){case"object-row-table":const i=s(t,this._headers);this.addObjectRow(i,e);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(100),this.arrayRows[this.length]=t,this.length++}}addObjectRow(t,e){switch(Number.isFinite(e)&&(this.cursor=e),this._headers||=function(t){return Object.keys(t)}(t),this.options.shape){case"array-row-table":const i=o(t,this._headers);this.addArrayRow(i,e);break;case"object-row-table":this.objectRows=this.objectRows||new Array(100),this.objectRows[this.length]=t,this.length++}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}}var m=i(76282);class v{schema;length=0;allocated=0;columns={};constructor(t,e){this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let e=0;for(const i in this.columns)this.columns[i][this.length]=t[e++];this.length++}addObjectRow(t){this._reallocateColumns();for(const e in t)this.columns[e][this.length]=t[e];this.length++}getBatch(){this._pruneColumns();return{shape:"columnar-table",batchType:"data",data:this.columns,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:100,this.columns={};for(const t of this.schema.fields){const e=(0,a.my)(t.type,t.nullable),i=this.columns[t.name];if(i)if(Array.isArray(i))i.length=this.allocated;else{if(!(0,m.iu)(i))throw new Error("Invalid column type");{const n=new e(this.allocated);n.set(i),this.columns[t.name]=n}}else this.columns[t.name]=new e(this.allocated)}}}_pruneColumns(){for(const[t,e]of Object.entries(this.columns))this.columns[t]=e.slice(0,this.length)}}var b,w;!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t[t.DurationSecond=-27]="DurationSecond",t[t.DurationMillisecond=-28]="DurationMillisecond",t[t.DurationMicrosecond=-29]="DurationMicrosecond",t[t.DurationNanosecond=-30]="DurationNanosecond",t[t.IntervalMonthDayNano=-31]="IntervalMonthDayNano"}(b||(b={})),function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"}(w||(w={}));function S(t){if(null===t)return"null";if(undefined===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>S(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}const T=new TextDecoder("utf-8"),I=T.decode.bind(T),A=new TextEncoder,D=t=>A.encode(t),_=t=>"function"==typeof t,O=t=>null!=t&&Object(t)===t,B="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function M(t,e){let i=O(n=e)&&"done"in n&&"value"in n?e.value:e;var n;return i instanceof t?t===Uint8Array?new t(i.buffer,i.byteOffset,i.byteLength):i:i?("string"==typeof i&&(i=D(i)),i instanceof ArrayBuffer||i instanceof B?new t(i):(t=>O(t)&&_(t.clear)&&_(t.bytes)&&_(t.position)&&_(t.setPosition)&&_(t.capacity)&&_(t.getBufferIdentifier)&&_(t.createLong))(i)?M(t,i.bytes()):ArrayBuffer.isView(i)?i.byteLength<=0?new t(0):new t(i.buffer,i.byteOffset,i.byteLength/t.BYTES_PER_ELEMENT):t.from(i)):new t(0)}const C=t=>M(Int32Array,t),U=t=>M(BigInt64Array,t),x=t=>M(Uint8Array,t);function N(t){if("bigint"==typeof t&&(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER))throw new TypeError(`${t} is not safe to convert to a number.`);return Number(t)}function E(t,e){return N(t/e)+N(t%e)/N(e)}const F=Symbol.for("isArrowBigNum");function L(t,...e){return 0===e.length?Object.setPrototypeOf(M(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function k(...t){return L.apply(this,t)}function j(...t){return L.apply(this,t)}function R(...t){return L.apply(this,t)}L.prototype[F]=!0,L.prototype.toJSON=function(){return`"${V(this)}"`},L.prototype.valueOf=function(t){return z(this,t)},L.prototype.toString=function(){return V(this)},L.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return z(this);case"string":return V(this);case"default":return function(t){if(8===t.byteLength){return new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}return V(t)}(this)}return V(this)},Object.setPrototypeOf(k.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(j.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(R.prototype,Object.create(Uint32Array.prototype)),Object.assign(k.prototype,L.prototype,{constructor:k,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(j.prototype,L.prototype,{constructor:j,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(R.prototype,L.prototype,{constructor:R,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const $=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);function z(t,e){const{buffer:i,byteOffset:n,byteLength:r,signed:s}=t,o=new BigUint64Array(i,n,r/8),a=s&&o.at(-1)&BigInt(1)<<BigInt(63);let l=BigInt(0),u=0;if(a){for(const t of o)l|=(t^$)*(BigInt(1)<<BigInt(64*u++));l*=BigInt(-1),l-=BigInt(1)}else for(const c of o)l|=c*(BigInt(1)<<BigInt(64*u++));if("number"==typeof e&&e>0){const t=BigInt("1".padEnd(e+1,"0")),i=a?-l%t:l%t,n=N(l/t);return+`${a&&0===n?"-":""}${n}.${`${i}`.padStart(e,"0")}`}return N(l)}function V(t){if(8===t.byteLength){return`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`}if(!t.signed)return P(t);let e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);if(new Int16Array([e.at(-1)])[0]>=0)return P(t);e=e.slice();let i=1;for(let n=0;n<e.length;n++){const t=e[n],r=~t+i;e[n]=r,i&=0===t?1:0}return`-${P(e)}`}function P(t){let e="";const i=new Uint32Array(2);let n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const r=new Uint32Array((n=new Uint16Array(n).reverse()).buffer);let s=-1;const o=n.length-1;do{for(i[0]=n[s=0];s<o;)n[s++]=i[1]=i[0]/10,i[0]=(i[0]-10*i[1]<<16)+n[s];n[s]=i[1]=i[0]/10,i[0]=i[0]-10*i[1],e=`${i[0]}${e}`}while(r[0]||r[1]||r[2]||r[3]);return null!=e?e:"0"}class Y{static new(t,e){switch(e){case!0:return new k(t);case!1:return new j(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new k(t)}return 16===t.byteLength?new R(t):new j(t)}static signed(t){return new k(t)}static unsigned(t){return new j(t)}static decimal(t){return new R(t)}constructor(t,e){return Y.new(t,e)}}var H,q,W,J,G,K,Q,Z,X,tt,et,it,nt,rt,st,ot,at;!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(H||(H={})),function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(q||(q={})),function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(W||(W={})),function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(J||(J={})),function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(G||(G={}));class lt{static isNull(t){return(null==t?void 0:t.typeId)===b.Null}static isInt(t){return(null==t?void 0:t.typeId)===b.Int}static isFloat(t){return(null==t?void 0:t.typeId)===b.Float}static isBinary(t){return(null==t?void 0:t.typeId)===b.Binary}static isLargeBinary(t){return(null==t?void 0:t.typeId)===b.LargeBinary}static isUtf8(t){return(null==t?void 0:t.typeId)===b.Utf8}static isLargeUtf8(t){return(null==t?void 0:t.typeId)===b.LargeUtf8}static isBool(t){return(null==t?void 0:t.typeId)===b.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===b.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===b.Date}static isTime(t){return(null==t?void 0:t.typeId)===b.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===b.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===b.Interval}static isDuration(t){return(null==t?void 0:t.typeId)===b.Duration}static isList(t){return(null==t?void 0:t.typeId)===b.List}static isStruct(t){return(null==t?void 0:t.typeId)===b.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===b.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===b.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===b.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===b.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===b.Dictionary}static isDenseUnion(t){return lt.isUnion(t)&&t.mode===G.Dense}static isSparseUnion(t){return lt.isUnion(t)&&t.mode===G.Sparse}constructor(t){this.typeId=t}}K=Symbol.toStringTag,lt[K]=((at=lt.prototype).children=null,at.ArrayType=Array,at.OffsetArrayType=Int32Array,at[Symbol.toStringTag]="DataType");class ut extends lt{constructor(){super(b.Null)}toString(){return"Null"}}Q=Symbol.toStringTag,ut[Q]=(t=>t[Symbol.toStringTag]="Null")(ut.prototype);class ct extends lt{constructor(t,e){super(b.Int),this.isSigned=t,this.bitWidth=e}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Z=Symbol.toStringTag,ct[Z]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(ct.prototype);class ht extends ct{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class pt extends ct{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class yt extends ct{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class dt extends ct{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class ft extends ct{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class gt extends ct{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class mt extends ct{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class vt extends ct{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(ht.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(pt.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(yt.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(dt.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(ft.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(gt.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(mt.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(vt.prototype,"ArrayType",{value:BigUint64Array});class bt extends lt{constructor(t){super(b.Float),this.precision=t}get ArrayType(){switch(this.precision){case H.HALF:return Uint16Array;case H.SINGLE:return Float32Array;case H.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}X=Symbol.toStringTag,bt[X]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(bt.prototype);class wt extends bt{constructor(){super(H.SINGLE)}}class St extends bt{constructor(){super(H.DOUBLE)}}Object.defineProperty(class extends bt{constructor(){super(H.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(wt.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(St.prototype,"ArrayType",{value:Float64Array});class Tt extends lt{constructor(){super(b.Binary)}toString(){return"Binary"}}Tt[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Tt.prototype);class It extends lt{constructor(){super(b.LargeBinary)}toString(){return"LargeBinary"}}It[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeBinary"))(It.prototype);class At extends lt{constructor(){super(b.Utf8)}toString(){return"Utf8"}}At[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(At.prototype);class Dt extends lt{constructor(){super(b.LargeUtf8)}toString(){return"LargeUtf8"}}Dt[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t.OffsetArrayType=BigInt64Array,t[Symbol.toStringTag]="LargeUtf8"))(Dt.prototype);class _t extends lt{constructor(){super(b.Bool)}toString(){return"Bool"}}_t[Symbol.toStringTag]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(_t.prototype);class Ot extends lt{constructor(t,e,i=128){super(b.Decimal),this.scale=t,this.precision=e,this.bitWidth=i}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}Ot[Symbol.toStringTag]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Ot.prototype);class Bt extends lt{constructor(t){super(b.Date),this.unit=t}toString(){return`Date${32*(this.unit+1)}<${W[this.unit]}>`}get ArrayType(){return this.unit===W.DAY?Int32Array:BigInt64Array}}tt=Symbol.toStringTag,Bt[tt]=(t=>(t.unit=null,t[Symbol.toStringTag]="Date"))(Bt.prototype);class Mt extends lt{constructor(t,e){super(b.Time),this.unit=t,this.bitWidth=e}toString(){return`Time${this.bitWidth}<${q[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}et=Symbol.toStringTag,Mt[et]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(Mt.prototype);class Ct extends lt{constructor(t,e){super(b.Timestamp),this.unit=t,this.timezone=e}toString(){return`Timestamp<${q[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}it=Symbol.toStringTag,Ct[it]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Timestamp"))(Ct.prototype);class Ut extends lt{constructor(t){super(b.Interval),this.unit=t}toString(){return`Interval<${J[this.unit]}>`}}nt=Symbol.toStringTag,Ut[nt]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Ut.prototype);class xt extends lt{constructor(t){super(b.Duration),this.unit=t}toString(){return`Duration<${q[this.unit]}>`}}rt=Symbol.toStringTag,xt[rt]=(t=>(t.unit=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Duration"))(xt.prototype);class Nt extends lt{constructor(t){super(b.List),this.children=[t]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Nt[Symbol.toStringTag]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Nt.prototype);class Et extends lt{constructor(t){super(b.Struct),this.children=t}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}st=Symbol.toStringTag,Et[st]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Et.prototype);class Ft extends lt{constructor(t,e,i){super(b.Union),this.mode=t,this.children=i,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,i)=>(t[e]=i)&&t||t),Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}ot=Symbol.toStringTag,Ft[ot]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(Ft.prototype);class Lt extends lt{constructor(t){super(b.FixedSizeBinary),this.byteWidth=t}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Lt[Symbol.toStringTag]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Lt.prototype);class kt extends lt{constructor(t,e){super(b.FixedSizeList),this.listSize=t,this.children=[e]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}kt[Symbol.toStringTag]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(kt.prototype);class jt extends lt{constructor(t,e=!1){var i,n,r;if(super(b.Map),this.children=[t],this.keysSorted=e,t&&(t.name="entries",null===(i=null==t?void 0:t.type)||void 0===i?void 0:i.children)){const e=null===(n=null==t?void 0:t.type)||void 0===n?void 0:n.children[0];e&&(e.name="key");const i=null===(r=null==t?void 0:t.type)||void 0===r?void 0:r.children[1];i&&(i.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}jt[Symbol.toStringTag]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(jt.prototype);const Rt=($t=-1,()=>++$t);var $t;class zt extends lt{constructor(t,e,i,n){super(b.Dictionary),this.indices=e,this.dictionary=t,this.isOrdered=n||!1,this.id=null==i?Rt():N(i)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function Vt(t){const e=t;switch(t.typeId){case b.Decimal:return t.bitWidth/32;case b.Interval:return e.unit===J.MONTH_DAY_NANO?4:1+e.unit;case b.FixedSizeList:return e.listSize;case b.FixedSizeBinary:return e.byteWidth;default:return 1}}zt[Symbol.toStringTag]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(zt.prototype);class Pt{visitMany(t,...e){return t.map(((t,i)=>this.visit(t,...e.map((t=>t[i])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,i=!0){if("number"==typeof e)return Yt(t,e,i);if("string"==typeof e&&e in b)return Yt(t,b[e],i);if(e&&e instanceof lt)return Yt(t,Ht(e),i);if((null==e?void 0:e.type)&&e.type instanceof lt)return Yt(t,Ht(e.type),i);return Yt(t,b.NONE,i)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return Yt(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitLargeUtf8(t,...e){return null}visitBinary(t,...e){return null}visitLargeBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitDuration(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function Yt(t,e,i=!0){let n=null;switch(e){case b.Null:n=t.visitNull;break;case b.Bool:n=t.visitBool;break;case b.Int:n=t.visitInt;break;case b.Int8:n=t.visitInt8||t.visitInt;break;case b.Int16:n=t.visitInt16||t.visitInt;break;case b.Int32:n=t.visitInt32||t.visitInt;break;case b.Int64:n=t.visitInt64||t.visitInt;break;case b.Uint8:n=t.visitUint8||t.visitInt;break;case b.Uint16:n=t.visitUint16||t.visitInt;break;case b.Uint32:n=t.visitUint32||t.visitInt;break;case b.Uint64:n=t.visitUint64||t.visitInt;break;case b.Float:n=t.visitFloat;break;case b.Float16:n=t.visitFloat16||t.visitFloat;break;case b.Float32:n=t.visitFloat32||t.visitFloat;break;case b.Float64:n=t.visitFloat64||t.visitFloat;break;case b.Utf8:n=t.visitUtf8;break;case b.LargeUtf8:n=t.visitLargeUtf8;break;case b.Binary:n=t.visitBinary;break;case b.LargeBinary:n=t.visitLargeBinary;break;case b.FixedSizeBinary:n=t.visitFixedSizeBinary;break;case b.Date:n=t.visitDate;break;case b.DateDay:n=t.visitDateDay||t.visitDate;break;case b.DateMillisecond:n=t.visitDateMillisecond||t.visitDate;break;case b.Timestamp:n=t.visitTimestamp;break;case b.TimestampSecond:n=t.visitTimestampSecond||t.visitTimestamp;break;case b.TimestampMillisecond:n=t.visitTimestampMillisecond||t.visitTimestamp;break;case b.TimestampMicrosecond:n=t.visitTimestampMicrosecond||t.visitTimestamp;break;case b.TimestampNanosecond:n=t.visitTimestampNanosecond||t.visitTimestamp;break;case b.Time:n=t.visitTime;break;case b.TimeSecond:n=t.visitTimeSecond||t.visitTime;break;case b.TimeMillisecond:n=t.visitTimeMillisecond||t.visitTime;break;case b.TimeMicrosecond:n=t.visitTimeMicrosecond||t.visitTime;break;case b.TimeNanosecond:n=t.visitTimeNanosecond||t.visitTime;break;case b.Decimal:n=t.visitDecimal;break;case b.List:n=t.visitList;break;case b.Struct:n=t.visitStruct;break;case b.Union:n=t.visitUnion;break;case b.DenseUnion:n=t.visitDenseUnion||t.visitUnion;break;case b.SparseUnion:n=t.visitSparseUnion||t.visitUnion;break;case b.Dictionary:n=t.visitDictionary;break;case b.Interval:n=t.visitInterval;break;case b.IntervalDayTime:n=t.visitIntervalDayTime||t.visitInterval;break;case b.IntervalYearMonth:n=t.visitIntervalYearMonth||t.visitInterval;break;case b.IntervalMonthDayNano:n=t.visitIntervalMonthDayNano||t.visitInterval;break;case b.Duration:n=t.visitDuration;break;case b.DurationSecond:n=t.visitDurationSecond||t.visitDuration;break;case b.DurationMillisecond:n=t.visitDurationMillisecond||t.visitDuration;break;case b.DurationMicrosecond:n=t.visitDurationMicrosecond||t.visitDuration;break;case b.DurationNanosecond:n=t.visitDurationNanosecond||t.visitDuration;break;case b.FixedSizeList:n=t.visitFixedSizeList;break;case b.Map:n=t.visitMap}if("function"==typeof n)return n;if(!i)return()=>null;throw new Error(`Unrecognized type '${b[e]}'`)}function Ht(t){switch(t.typeId){case b.Null:return b.Null;case b.Int:{const{bitWidth:e,isSigned:i}=t;switch(e){case 8:return i?b.Int8:b.Uint8;case 16:return i?b.Int16:b.Uint16;case 32:return i?b.Int32:b.Uint32;case 64:return i?b.Int64:b.Uint64}return b.Int}case b.Float:switch(t.precision){case H.HALF:return b.Float16;case H.SINGLE:return b.Float32;case H.DOUBLE:return b.Float64}return b.Float;case b.Binary:return b.Binary;case b.LargeBinary:return b.LargeBinary;case b.Utf8:return b.Utf8;case b.LargeUtf8:return b.LargeUtf8;case b.Bool:return b.Bool;case b.Decimal:return b.Decimal;case b.Time:switch(t.unit){case q.SECOND:return b.TimeSecond;case q.MILLISECOND:return b.TimeMillisecond;case q.MICROSECOND:return b.TimeMicrosecond;case q.NANOSECOND:return b.TimeNanosecond}return b.Time;case b.Timestamp:switch(t.unit){case q.SECOND:return b.TimestampSecond;case q.MILLISECOND:return b.TimestampMillisecond;case q.MICROSECOND:return b.TimestampMicrosecond;case q.NANOSECOND:return b.TimestampNanosecond}return b.Timestamp;case b.Date:switch(t.unit){case W.DAY:return b.DateDay;case W.MILLISECOND:return b.DateMillisecond}return b.Date;case b.Interval:switch(t.unit){case J.DAY_TIME:return b.IntervalDayTime;case J.YEAR_MONTH:return b.IntervalYearMonth;case J.MONTH_DAY_NANO:return b.IntervalMonthDayNano}return b.Interval;case b.Duration:switch(t.unit){case q.SECOND:return b.DurationSecond;case q.MILLISECOND:return b.DurationMillisecond;case q.MICROSECOND:return b.DurationMicrosecond;case q.NANOSECOND:return b.DurationNanosecond}return b.Duration;case b.Map:return b.Map;case b.List:return b.List;case b.Struct:return b.Struct;case b.Union:switch(t.mode){case G.Dense:return b.DenseUnion;case G.Sparse:return b.SparseUnion}return b.Union;case b.FixedSizeBinary:return b.FixedSizeBinary;case b.FixedSizeList:return b.FixedSizeList;case b.Dictionary:return b.Dictionary}throw new Error(`Unrecognized type '${b[t.typeId]}'`)}Pt.prototype.visitInt8=null,Pt.prototype.visitInt16=null,Pt.prototype.visitInt32=null,Pt.prototype.visitInt64=null,Pt.prototype.visitUint8=null,Pt.prototype.visitUint16=null,Pt.prototype.visitUint32=null,Pt.prototype.visitUint64=null,Pt.prototype.visitFloat16=null,Pt.prototype.visitFloat32=null,Pt.prototype.visitFloat64=null,Pt.prototype.visitDateDay=null,Pt.prototype.visitDateMillisecond=null,Pt.prototype.visitTimestampSecond=null,Pt.prototype.visitTimestampMillisecond=null,Pt.prototype.visitTimestampMicrosecond=null,Pt.prototype.visitTimestampNanosecond=null,Pt.prototype.visitTimeSecond=null,Pt.prototype.visitTimeMillisecond=null,Pt.prototype.visitTimeMicrosecond=null,Pt.prototype.visitTimeNanosecond=null,Pt.prototype.visitDenseUnion=null,Pt.prototype.visitSparseUnion=null,Pt.prototype.visitIntervalDayTime=null,Pt.prototype.visitIntervalYearMonth=null,Pt.prototype.visitIntervalMonthDayNano=null,Pt.prototype.visitDuration=null,Pt.prototype.visitDurationSecond=null,Pt.prototype.visitDurationMillisecond=null,Pt.prototype.visitDurationMicrosecond=null,Pt.prototype.visitDurationNanosecond=null;const qt=new Float64Array(1),Wt=new Uint32Array(qt.buffer);function Jt(t){const e=(31744&t)>>10,i=(1023&t)/1024,n=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return n*(i?Number.NaN:1/0);case 0:return n*(i?6103515625e-14*i:0)}return n*Math.pow(2,e-15)*(1+i)}class Gt extends Pt{}function Kt(t){return(e,i,n)=>{if(e.setValid(i,null!=n))return t(e,i,n)}}const Qt=(t,e,i,n)=>{if(i+1<e.length){const r=N(e[i]),s=N(e[i+1]);t.set(n.subarray(0,s-r),r)}},Zt=({values:t},e,i)=>{t[e]=i},Xt=({values:t},e,i)=>{t[e]=i},te=({values:t},e,i)=>{t[e]=function(t){if(t!=t)return 32256;qt[0]=t;const e=(2147483648&Wt[1])>>16&65535;let i=2146435072&Wt[1],n=0;return i>=1089470464?Wt[0]>0?i=31744:(i=(2080374784&i)>>16,n=(1048575&Wt[1])>>10):i<=1056964608?(n=1048576+(1048575&Wt[1]),n=1048576+(n<<(i>>20)-998)>>21,i=0):(i=i-1056964608>>10,n=512+(1048575&Wt[1])>>10),e|i|65535&n}(i)},ee=({values:t},e,i)=>{((t,e,i)=>{t[e]=Math.floor(i/864e5)})(t,e,i.valueOf())},ie=({values:t},e,i)=>{t[e]=BigInt(i)},ne=({values:t,valueOffsets:e},i,n)=>Qt(t,e,i,n),re=({values:t,valueOffsets:e},i,n)=>Qt(t,e,i,D(n)),se=({values:t},e,i)=>{t[e]=BigInt(i/1e3)},oe=({values:t},e,i)=>{t[e]=BigInt(i)},ae=({values:t},e,i)=>{t[e]=BigInt(1e3*i)},le=({values:t},e,i)=>{t[e]=BigInt(1e6*i)},ue=({values:t},e,i)=>{t[e]=i},ce=({values:t},e,i)=>{t[e]=i},he=({values:t},e,i)=>{t[e]=i},pe=({values:t},e,i)=>{t[e]=i},ye=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];Te.visit(r,t.valueOffsets[e],i)},de=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];Te.visit(r,e,i)},fe=({values:t},e,i)=>{t.set(i.subarray(0,2),2*e)},ge=({values:t},e,i)=>{t[e]=12*i[0]+i[1]%12},me=({values:t,stride:e},i,n)=>{t.set(n.subarray(0,e),e*i)},ve=({values:t},e,i)=>{t[e]=i},be=({values:t},e,i)=>{t[e]=i},we=({values:t},e,i)=>{t[e]=i},Se=({values:t},e,i)=>{t[e]=i};Gt.prototype.visitBool=Kt((({offset:t,values:e},i,n)=>{const r=t+i;n?e[r>>3]|=1<<r%8:e[r>>3]&=~(1<<r%8)})),Gt.prototype.visitInt=Kt(Zt),Gt.prototype.visitInt8=Kt(Zt),Gt.prototype.visitInt16=Kt(Zt),Gt.prototype.visitInt32=Kt(Zt),Gt.prototype.visitInt64=Kt(Zt),Gt.prototype.visitUint8=Kt(Zt),Gt.prototype.visitUint16=Kt(Zt),Gt.prototype.visitUint32=Kt(Zt),Gt.prototype.visitUint64=Kt(Zt),Gt.prototype.visitFloat=Kt(((t,e,i)=>{switch(t.type.precision){case H.HALF:return te(t,e,i);case H.SINGLE:case H.DOUBLE:return Xt(t,e,i)}})),Gt.prototype.visitFloat16=Kt(te),Gt.prototype.visitFloat32=Kt(Xt),Gt.prototype.visitFloat64=Kt(Xt),Gt.prototype.visitUtf8=Kt(re),Gt.prototype.visitLargeUtf8=Kt(re),Gt.prototype.visitBinary=Kt(ne),Gt.prototype.visitLargeBinary=Kt(ne),Gt.prototype.visitFixedSizeBinary=Kt((({stride:t,values:e},i,n)=>{e.set(n.subarray(0,t),t*i)})),Gt.prototype.visitDate=Kt(((t,e,i)=>{t.type.unit===W.DAY?ee(t,e,i):ie(t,e,i)})),Gt.prototype.visitDateDay=Kt(ee),Gt.prototype.visitDateMillisecond=Kt(ie),Gt.prototype.visitTimestamp=Kt(((t,e,i)=>{switch(t.type.unit){case q.SECOND:return se(t,e,i);case q.MILLISECOND:return oe(t,e,i);case q.MICROSECOND:return ae(t,e,i);case q.NANOSECOND:return le(t,e,i)}})),Gt.prototype.visitTimestampSecond=Kt(se),Gt.prototype.visitTimestampMillisecond=Kt(oe),Gt.prototype.visitTimestampMicrosecond=Kt(ae),Gt.prototype.visitTimestampNanosecond=Kt(le),Gt.prototype.visitTime=Kt(((t,e,i)=>{switch(t.type.unit){case q.SECOND:return ue(t,e,i);case q.MILLISECOND:return ce(t,e,i);case q.MICROSECOND:return he(t,e,i);case q.NANOSECOND:return pe(t,e,i)}})),Gt.prototype.visitTimeSecond=Kt(ue),Gt.prototype.visitTimeMillisecond=Kt(ce),Gt.prototype.visitTimeMicrosecond=Kt(he),Gt.prototype.visitTimeNanosecond=Kt(pe),Gt.prototype.visitDecimal=Kt((({values:t,stride:e},i,n)=>{t.set(n.subarray(0,e),e*i)})),Gt.prototype.visitList=Kt(((t,e,i)=>{const n=t.children[0],r=t.valueOffsets,s=Te.getVisitFn(n);if(Array.isArray(i))for(let o=-1,a=r[e],l=r[e+1];a<l;)s(n,a++,i[++o]);else for(let o=-1,a=r[e],l=r[e+1];a<l;)s(n,a++,i.get(++o))})),Gt.prototype.visitStruct=Kt(((t,e,i)=>{const n=t.type.children.map((t=>Te.getVisitFn(t.type))),r=i instanceof Map?(s=e,o=i,(t,e,i,n)=>e&&t(e,s,o.get(i.name))):i instanceof zi?((t,e)=>(i,n,r,s)=>n&&i(n,t,e.get(s)))(e,i):Array.isArray(i)?((t,e)=>(i,n,r,s)=>n&&i(n,t,e[s]))(e,i):((t,e)=>(i,n,r,s)=>n&&i(n,t,e[r.name]))(e,i);var s,o;t.type.children.forEach(((e,i)=>r(n[i],t.children[i],e,i)))})),Gt.prototype.visitUnion=Kt(((t,e,i)=>{t.type.mode===G.Dense?ye(t,e,i):de(t,e,i)})),Gt.prototype.visitDenseUnion=Kt(ye),Gt.prototype.visitSparseUnion=Kt(de),Gt.prototype.visitDictionary=Kt(((t,e,i)=>{var n;null===(n=t.dictionary)||void 0===n||n.set(t.values[e],i)})),Gt.prototype.visitInterval=Kt(((t,e,i)=>{switch(t.type.unit){case J.YEAR_MONTH:return ge(t,e,i);case J.DAY_TIME:return fe(t,e,i);case J.MONTH_DAY_NANO:return me(t,e,i)}})),Gt.prototype.visitIntervalDayTime=Kt(fe),Gt.prototype.visitIntervalYearMonth=Kt(ge),Gt.prototype.visitIntervalMonthDayNano=Kt(me),Gt.prototype.visitDuration=Kt(((t,e,i)=>{switch(t.type.unit){case q.SECOND:return ve(t,e,i);case q.MILLISECOND:return be(t,e,i);case q.MICROSECOND:return we(t,e,i);case q.NANOSECOND:return Se(t,e,i)}})),Gt.prototype.visitDurationSecond=Kt(ve),Gt.prototype.visitDurationMillisecond=Kt(be),Gt.prototype.visitDurationMicrosecond=Kt(we),Gt.prototype.visitDurationNanosecond=Kt(Se),Gt.prototype.visitFixedSizeList=Kt(((t,e,i)=>{const{stride:n}=t,r=t.children[0],s=Te.getVisitFn(r);if(Array.isArray(i))for(let o=-1,a=e*n;++o<n;)s(r,a+o,i[o]);else for(let o=-1,a=e*n;++o<n;)s(r,a+o,i.get(o))})),Gt.prototype.visitMap=Kt(((t,e,i)=>{const n=t.children[0],{valueOffsets:r}=t,s=Te.getVisitFn(n);let{[e]:o,[e+1]:a}=r;const l=i instanceof Map?i.entries():Object.entries(i);for(const u of l)if(s(n,o,u),++o>=a)break}));const Te=new Gt,Ie=Symbol.for("parent"),Ae=Symbol.for("rowIndex");class De{constructor(t,e){return this[Ie]=t,this[Ae]=e,new Proxy(this,Oe)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Ae],e=this[Ie],i=e.type.children,n={};for(let r=-1,s=i.length;++r<s;)n[i[r].name]=ti.visit(e.children[r],t);return n}toString(){return`{${[...this].map((([t,e])=>`${S(t)}: ${S(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new _e(this[Ie],this[Ae])}}class _e{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,ti.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(De.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ie]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ae]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});const Oe=new class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ie].type.children.map((t=>t.name))}has(t,e){return t[Ie].type.children.some((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(t[Ie].type.children.some((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[Ie].type.children.findIndex((t=>t.name===e));if(-1!==i){const n=ti.visit(t[Ie].children[i],t[Ae]);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[Ie].type.children.findIndex((t=>t.name===e));return-1!==n?(Te.visit(t[Ie].children[n],t[Ae],i),Reflect.set(t,e,i)):!(!Reflect.has(t,e)&&"symbol"!=typeof e)&&Reflect.set(t,e,i)}};class Be extends Pt{}function Me(t){return(e,i)=>e.getValid(i)?t(e,i):null}const Ce=(t,e,i)=>{if(i+1>=e.length)return null;const n=N(e[i]),r=N(e[i+1]);return t.subarray(n,r)},Ue=({values:t},e)=>((t,e)=>864e5*t[e])(t,e),xe=({values:t},e)=>N(t[e]),Ne=({stride:t,values:e},i)=>e[t*i],Ee=({values:t},e)=>t[e],Fe=({values:t,valueOffsets:e},i)=>Ce(t,e,i),Le=({values:t,valueOffsets:e},i)=>{const n=Ce(t,e,i);return null!==n?I(n):null},ke=({values:t},e)=>1e3*N(t[e]),je=({values:t},e)=>N(t[e]),Re=({values:t},e)=>E(t[e],BigInt(1e3)),$e=({values:t},e)=>E(t[e],BigInt(1e6)),ze=({values:t},e)=>t[e],Ve=({values:t},e)=>t[e],Pe=({values:t},e)=>t[e],Ye=({values:t},e)=>t[e],He=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return ti.visit(n,t.valueOffsets[e])},qe=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return ti.visit(n,e)},We=({values:t},e)=>t.subarray(2*e,2*(e+1)),Je=({values:t},e)=>{const i=t[e],n=new Int32Array(2);return n[0]=Math.trunc(i/12),n[1]=Math.trunc(i%12),n},Ge=({values:t},e)=>t.subarray(4*e,4*(e+1)),Ke=({values:t},e)=>t[e],Qe=({values:t},e)=>t[e],Ze=({values:t},e)=>t[e],Xe=({values:t},e)=>t[e];Be.prototype.visitNull=Me(((t,e)=>null)),Be.prototype.visitBool=Me((({offset:t,values:e},i)=>{const n=t+i;return!!(e[n>>3]&1<<n%8)})),Be.prototype.visitInt=Me((({values:t},e)=>t[e])),Be.prototype.visitInt8=Me(Ne),Be.prototype.visitInt16=Me(Ne),Be.prototype.visitInt32=Me(Ne),Be.prototype.visitInt64=Me(Ee),Be.prototype.visitUint8=Me(Ne),Be.prototype.visitUint16=Me(Ne),Be.prototype.visitUint32=Me(Ne),Be.prototype.visitUint64=Me(Ee),Be.prototype.visitFloat=Me((({type:t,values:e},i)=>t.precision!==H.HALF?e[i]:Jt(e[i]))),Be.prototype.visitFloat16=Me((({stride:t,values:e},i)=>Jt(e[t*i]))),Be.prototype.visitFloat32=Me(Ne),Be.prototype.visitFloat64=Me(Ne),Be.prototype.visitUtf8=Me(Le),Be.prototype.visitLargeUtf8=Me(Le),Be.prototype.visitBinary=Me(Fe),Be.prototype.visitLargeBinary=Me(Fe),Be.prototype.visitFixedSizeBinary=Me((({stride:t,values:e},i)=>e.subarray(t*i,t*(i+1)))),Be.prototype.visitDate=Me(((t,e)=>t.type.unit===W.DAY?Ue(t,e):xe(t,e))),Be.prototype.visitDateDay=Me(Ue),Be.prototype.visitDateMillisecond=Me(xe),Be.prototype.visitTimestamp=Me(((t,e)=>{switch(t.type.unit){case q.SECOND:return ke(t,e);case q.MILLISECOND:return je(t,e);case q.MICROSECOND:return Re(t,e);case q.NANOSECOND:return $e(t,e)}})),Be.prototype.visitTimestampSecond=Me(ke),Be.prototype.visitTimestampMillisecond=Me(je),Be.prototype.visitTimestampMicrosecond=Me(Re),Be.prototype.visitTimestampNanosecond=Me($e),Be.prototype.visitTime=Me(((t,e)=>{switch(t.type.unit){case q.SECOND:return ze(t,e);case q.MILLISECOND:return Ve(t,e);case q.MICROSECOND:return Pe(t,e);case q.NANOSECOND:return Ye(t,e)}})),Be.prototype.visitTimeSecond=Me(ze),Be.prototype.visitTimeMillisecond=Me(Ve),Be.prototype.visitTimeMicrosecond=Me(Pe),Be.prototype.visitTimeNanosecond=Me(Ye),Be.prototype.visitDecimal=Me((({values:t,stride:e},i)=>Y.decimal(t.subarray(e*i,e*(i+1))))),Be.prototype.visitList=Me(((t,e)=>{const{valueOffsets:i,stride:n,children:r}=t,{[e*n]:s,[e*n+1]:o}=i,a=r[0].slice(s,o-s);return new zi([a])})),Be.prototype.visitStruct=Me(((t,e)=>new De(t,e))),Be.prototype.visitUnion=Me(((t,e)=>t.type.mode===G.Dense?He(t,e):qe(t,e))),Be.prototype.visitDenseUnion=Me(He),Be.prototype.visitSparseUnion=Me(qe),Be.prototype.visitDictionary=Me(((t,e)=>{var i;return null===(i=t.dictionary)||void 0===i?void 0:i.get(t.values[e])})),Be.prototype.visitInterval=Me(((t,e)=>t.type.unit===J.MONTH_DAY_NANO?Ge(t,e):t.type.unit===J.DAY_TIME?We(t,e):Je(t,e))),Be.prototype.visitIntervalDayTime=Me(We),Be.prototype.visitIntervalYearMonth=Me(Je),Be.prototype.visitIntervalMonthDayNano=Me(Ge),Be.prototype.visitDuration=Me(((t,e)=>{switch(t.type.unit){case q.SECOND:return Ke(t,e);case q.MILLISECOND:return Qe(t,e);case q.MICROSECOND:return Ze(t,e);case q.NANOSECOND:return Xe(t,e)}})),Be.prototype.visitDurationSecond=Me(Ke),Be.prototype.visitDurationMillisecond=Me(Qe),Be.prototype.visitDurationMicrosecond=Me(Ze),Be.prototype.visitDurationNanosecond=Me(Xe),Be.prototype.visitFixedSizeList=Me(((t,e)=>{const{stride:i,children:n}=t,r=n[0].slice(e*i,i);return new zi([r])})),Be.prototype.visitMap=Me(((t,e)=>{const{valueOffsets:i,children:n}=t,{[e]:r,[e+1]:s}=i,o=n[0];return new si(o.slice(r,s-r))}));const ti=new Be,ei=Symbol.for("keys"),ii=Symbol.for("vals"),ni=Symbol.for("kKeysAsStrings"),ri=Symbol.for("_kKeysAsStrings");class si{constructor(t){return this[ei]=new zi([t.children[0]]).memoize(),this[ii]=t.children[1],new Proxy(this,new ai)}get[ni](){return this[ri]||(this[ri]=Array.from(this[ei].toArray(),String))}[Symbol.iterator](){return new oi(this[ei],this[ii])}get size(){return this[ei].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ei],e=this[ii],i={};for(let n=-1,r=t.length;++n<r;)i[t.get(n)]=ti.visit(e,n);return i}toString(){return`{${[...this].map((([t,e])=>`${S(t)}: ${S(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class oi{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),ti.visit(this.vals,t)]})}}class ai{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[ni]}has(t,e){return t[ni].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[ni].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[ni].indexOf(e);if(-1!==i){const n=ti.visit(Reflect.get(t,ii),i);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[ni].indexOf(e);return-1!==n?(Te.visit(Reflect.get(t,ii),n,i),Reflect.set(t,e,i)):!!Reflect.has(t,e)&&Reflect.set(t,e,i)}}let li;function ui(t,e,i,n){const{length:r=0}=t;let s="number"!=typeof e?0:e,o="number"!=typeof i?r:i;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(li=s,s=o,o=li),o>r&&(o=r),n?n(t,s,o):[s,o]}Object.defineProperties(si.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ei]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ii]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ri]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const ci=(t,e)=>t<0?e+t:t,hi=t=>t!=t;function pi(t){if("object"!==typeof t||null===t)return hi(t)?hi:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let i=0;const n=t.length;if(n!==e.length)return!1;if(n>0)do{if(t[i]!==e[i])return!1}while(++i<n);return!0}(t,e):t instanceof Map?function(t){let e=-1;const i=[];for(const n of t.values())i[++e]=pi(n);return yi(i)}(t):Array.isArray(t)?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=pi(t[i]);return yi(e)}(t):t instanceof zi?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=pi(t.get(i));return yi(e)}(t):function(t,e=!1){const i=Object.keys(t);if(!e&&0===i.length)return()=>!1;const n=[];for(let r=-1,s=i.length;++r<s;)n[r]=pi(t[i[r]]);return yi(n,i)}(t,!0)}function yi(t,e){return i=>{if(!i||"object"!=typeof i)return!1;switch(i.constructor){case Array:return function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e[n]))return!1;return!0}(t,i);case Map:return di(t,i,i.keys());case si:case De:case Object:case void 0:return di(t,i,e||Object.keys(i))}return i instanceof zi&&function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e.get(n)))return!1;return!0}(t,i)}}function di(t,e,i){const n=i[Symbol.iterator](),r=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),s=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let o=0;const a=t.length;let l=s.next(),u=n.next(),c=r.next();for(;o<a&&!u.done&&!c.done&&!l.done&&(u.value===c.value&&t[o](l.value));++o,u=n.next(),c=r.next(),l=s.next());return!!(o===a&&u.done&&c.done&&l.done)||(n.return&&n.return(),r.return&&r.return(),s.return&&s.return(),!1)}class fi{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function gi(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function mi(t){return t.reduce(((t,e,i)=>(t[i+1]=t[i]+e.length,t)),new Uint32Array(t.length+1))}function vi(t,e,i,n){const r=[];for(let s=-1,o=t.length;++s<o;){const o=t[s],a=e[s],{length:l}=o;if(a>=n)break;if(i>=a+l)continue;if(a>=i&&a+l<=n){r.push(o);continue}const u=Math.max(0,i-a),c=Math.min(n-a,l);r.push(o.slice(u,c-u))}return 0===r.length&&r.push(t[0].slice(0,0)),r}function bi(t,e,i,n){let r=0,s=0,o=e.length-1;do{if(r>=o-1)return i<e[o]?n(t,r,i-e[r]):null;s=r+Math.trunc(.5*(o-r)),i<e[s]?o=s:r=s}while(r<o)}function wi(t,e){return t.getValid(e)}function Si(t){function e(e,i,n){return t(e[i],n)}return function(t){return bi(this.data,this._offsets,t,e)}}function Ti(t){let e;function i(i,n,r){return t(i[n],r,e)}return function(t,n){const r=this.data;e=n;const s=bi(r,this._offsets,t,i);return e=void 0,s}}function Ii(t){let e;function i(i,n,r){let s=r,o=0,a=0;for(let l=n-1,u=i.length;++l<u;){const n=i[l];if(~(o=t(n,e,s)))return a+o;s=0,a+=n.length}return-1}return function(t,n){e=t;const r=this.data,s="number"!=typeof n?i(r,0,0):bi(r,this._offsets,n,i);return e=void 0,s}}function Ai(t,e,i,n){return!!(i&1<<n)}function Di(t,e,i,n){return(i&1<<n)>>n}function _i(t,e,i){const n=i.byteLength+7&-8;if(t>0||i.byteLength<n){const r=new Uint8Array(n);return r.set(t%8==0?i.subarray(t>>3):function(t){const e=[];let i=0,n=0,r=0;for(const o of t)o&&(r|=1<<n),8==++n&&(e[i++]=r,r=n=0);(0===i||n>0)&&(e[i++]=r);const s=new Uint8Array(e.length+7&-8);return s.set(e),s}(new Oi(i,t,e,null,Ai)).subarray(0,n)),r}return i}class Oi{constructor(t,e,i,n,r){this.bytes=t,this.length=i,this.context=n,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Bi(t,e,i){if(i-e<=0)return 0;if(i-e<8){let n=0;for(const r of new Oi(t,e,i-e,t,Di))n+=r;return n}const n=i>>3<<3,r=e+(e%8==0?0:8-e%8);return Bi(t,e,r)+Bi(t,n,i)+function(t,e,i){let n=0,r=Math.trunc(e);const s=new DataView(t.buffer,t.byteOffset,t.byteLength),o=void 0===i?t.byteLength:r+i;for(;o-r>=4;)n+=Mi(s.getUint32(r)),r+=4;for(;o-r>=2;)n+=Mi(s.getUint16(r)),r+=2;for(;o-r>=1;)n+=Mi(s.getUint8(r)),r+=1;return n}(t,r>>3,n-r>>3)}function Mi(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class Ci extends Pt{}function Ui(t,e,i){if(void 0===e)return-1;if(null===e)switch(t.typeId){case b.Union:case b.Dictionary:break;default:return function(t,e){const{nullBitmap:i}=t;if(!i||t.nullCount<=0)return-1;let n=0;for(const r of new Oi(i,t.offset+(e||0),t.length,i,Ai)){if(!r)return n;++n}return-1}(t,i)}const n=ti.getVisitFn(t),r=pi(e);for(let s=(i||0)-1,o=t.length;++s<o;)if(r(n(t,s)))return s;return-1}function xi(t,e,i){const n=ti.getVisitFn(t),r=pi(e);for(let s=(i||0)-1,o=t.length;++s<o;)if(r(n(t,s)))return s;return-1}Ci.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},Ci.prototype.visitBool=Ui,Ci.prototype.visitInt=Ui,Ci.prototype.visitInt8=Ui,Ci.prototype.visitInt16=Ui,Ci.prototype.visitInt32=Ui,Ci.prototype.visitInt64=Ui,Ci.prototype.visitUint8=Ui,Ci.prototype.visitUint16=Ui,Ci.prototype.visitUint32=Ui,Ci.prototype.visitUint64=Ui,Ci.prototype.visitFloat=Ui,Ci.prototype.visitFloat16=Ui,Ci.prototype.visitFloat32=Ui,Ci.prototype.visitFloat64=Ui,Ci.prototype.visitUtf8=Ui,Ci.prototype.visitLargeUtf8=Ui,Ci.prototype.visitBinary=Ui,Ci.prototype.visitLargeBinary=Ui,Ci.prototype.visitFixedSizeBinary=Ui,Ci.prototype.visitDate=Ui,Ci.prototype.visitDateDay=Ui,Ci.prototype.visitDateMillisecond=Ui,Ci.prototype.visitTimestamp=Ui,Ci.prototype.visitTimestampSecond=Ui,Ci.prototype.visitTimestampMillisecond=Ui,Ci.prototype.visitTimestampMicrosecond=Ui,Ci.prototype.visitTimestampNanosecond=Ui,Ci.prototype.visitTime=Ui,Ci.prototype.visitTimeSecond=Ui,Ci.prototype.visitTimeMillisecond=Ui,Ci.prototype.visitTimeMicrosecond=Ui,Ci.prototype.visitTimeNanosecond=Ui,Ci.prototype.visitDecimal=Ui,Ci.prototype.visitList=Ui,Ci.prototype.visitStruct=Ui,Ci.prototype.visitUnion=Ui,Ci.prototype.visitDenseUnion=xi,Ci.prototype.visitSparseUnion=xi,Ci.prototype.visitDictionary=Ui,Ci.prototype.visitInterval=Ui,Ci.prototype.visitIntervalDayTime=Ui,Ci.prototype.visitIntervalYearMonth=Ui,Ci.prototype.visitIntervalMonthDayNano=Ui,Ci.prototype.visitDuration=Ui,Ci.prototype.visitDurationSecond=Ui,Ci.prototype.visitDurationMillisecond=Ui,Ci.prototype.visitDurationMicrosecond=Ui,Ci.prototype.visitDurationNanosecond=Ui,Ci.prototype.visitFixedSizeList=Ui,Ci.prototype.visitMap=Ui;const Ni=new Ci;class Ei extends Pt{}function Fi(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(lt.isInt(e)&&64!==e.bitWidth||lt.isTime(e)&&64!==e.bitWidth||lt.isFloat(e)&&e.precision!==H.HALF))return new fi(t.data.length,(e=>{const i=t.data[e];return i.values.subarray(0,i.length)[Symbol.iterator]()}));let i=0;return new fi(t.data.length,(e=>{const n=t.data[e].length,r=t.slice(i,i+n);return i+=n,new Li(r)}))}class Li{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Ei.prototype.visitNull=Fi,Ei.prototype.visitBool=Fi,Ei.prototype.visitInt=Fi,Ei.prototype.visitInt8=Fi,Ei.prototype.visitInt16=Fi,Ei.prototype.visitInt32=Fi,Ei.prototype.visitInt64=Fi,Ei.prototype.visitUint8=Fi,Ei.prototype.visitUint16=Fi,Ei.prototype.visitUint32=Fi,Ei.prototype.visitUint64=Fi,Ei.prototype.visitFloat=Fi,Ei.prototype.visitFloat16=Fi,Ei.prototype.visitFloat32=Fi,Ei.prototype.visitFloat64=Fi,Ei.prototype.visitUtf8=Fi,Ei.prototype.visitLargeUtf8=Fi,Ei.prototype.visitBinary=Fi,Ei.prototype.visitLargeBinary=Fi,Ei.prototype.visitFixedSizeBinary=Fi,Ei.prototype.visitDate=Fi,Ei.prototype.visitDateDay=Fi,Ei.prototype.visitDateMillisecond=Fi,Ei.prototype.visitTimestamp=Fi,Ei.prototype.visitTimestampSecond=Fi,Ei.prototype.visitTimestampMillisecond=Fi,Ei.prototype.visitTimestampMicrosecond=Fi,Ei.prototype.visitTimestampNanosecond=Fi,Ei.prototype.visitTime=Fi,Ei.prototype.visitTimeSecond=Fi,Ei.prototype.visitTimeMillisecond=Fi,Ei.prototype.visitTimeMicrosecond=Fi,Ei.prototype.visitTimeNanosecond=Fi,Ei.prototype.visitDecimal=Fi,Ei.prototype.visitList=Fi,Ei.prototype.visitStruct=Fi,Ei.prototype.visitUnion=Fi,Ei.prototype.visitDenseUnion=Fi,Ei.prototype.visitSparseUnion=Fi,Ei.prototype.visitDictionary=Fi,Ei.prototype.visitInterval=Fi,Ei.prototype.visitIntervalDayTime=Fi,Ei.prototype.visitIntervalYearMonth=Fi,Ei.prototype.visitIntervalMonthDayNano=Fi,Ei.prototype.visitDuration=Fi,Ei.prototype.visitDurationSecond=Fi,Ei.prototype.visitDurationMillisecond=Fi,Ei.prototype.visitDurationMicrosecond=Fi,Ei.prototype.visitDurationNanosecond=Fi,Ei.prototype.visitFixedSizeList=Fi,Ei.prototype.visitMap=Fi;const ki=new Ei;var ji;const Ri={},$i={};class zi{constructor(t){var e,i,n;const r=t[0]instanceof zi?t.flatMap((t=>t.data)):t;if(0===r.length||r.some((t=>!(t instanceof Yi))))throw new TypeError("Vector constructor expects an Array of Data instances.");const s=null===(e=r[0])||void 0===e?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:i}=Ri[s.typeId],n=r[0];this.isValid=t=>wi(n,t),this.get=e=>t(n,e),this.set=(t,i)=>e(n,t,i),this.indexOf=t=>i(n,t),this._offsets=[0,n.length];break}default:Object.setPrototypeOf(this,$i[s.typeId]),this._offsets=mi(r)}this.data=r,this.type=s,this.stride=Vt(s),this.numChildren=null!==(n=null===(i=s.children)||void 0===i?void 0:i.length)&&void 0!==n?n:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce(((t,e)=>t+e.byteLength),0)}get nullable(){return this.data.some((t=>t.nullable))}get nullCount(){return gi(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${b[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}at(t){return this.get(ci(t,this.length))}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>-1}[Symbol.iterator](){return ki.visit(this)}concat(...t){return new zi(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new zi(ui(this,t,e,(({data:t,_offsets:e},i,n)=>vi(t,e,i,n))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:i,stride:n,ArrayType:r}=this;switch(t.typeId){case b.Int:case b.Float:case b.Decimal:case b.Time:case b.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,i*n);default:return e.reduce(((t,{values:e,length:i})=>(t.array.set(e.subarray(0,i*n),t.offset),t.offset+=i*n,t)),{array:new r(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new zi(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!lt.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(lt.isDictionary(this.type)){const t=new Vi(this.data[0].dictionary),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new zi(e)}return new Vi(this)}unmemoize(){if(lt.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new zi(e)}return this}}ji=Symbol.toStringTag,zi[ji]=(t=>{t.type=lt.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(b).map((t=>b[t])).filter((t=>"number"==typeof t&&t!==b.NONE));for(const i of e){const e=ti.getVisitFnByTypeId(i),n=Te.getVisitFnByTypeId(i),r=Ni.getVisitFnByTypeId(i);Ri[i]={get:e,set:n,indexOf:r},$i[i]=Object.create(t,{isValid:{value:Si(wi)},get:{value:Si(ti.getVisitFnByTypeId(i))},set:{value:Ti(Te.getVisitFnByTypeId(i))},indexOf:{value:Ii(Ni.getVisitFnByTypeId(i))}})}return"Vector"})(zi.prototype);class Vi extends zi{constructor(t){super(t.data);const e=this.get,i=this.set,n=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(t){const i=r[t];if(void 0!==i)return i;const n=e.call(this,t);return r[t]=n,n}}),Object.defineProperty(this,"set",{value(t,e){i.call(this,t,e),r[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new Vi(n.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new zi(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function Pi(t){if(t){if(t instanceof Yi)return new zi([t]);if(t instanceof zi)return new zi(t.data);if(t.type instanceof lt)return new zi([Wi(t)]);if(Array.isArray(t))return new zi(t.flatMap((t=>{return(e=t)instanceof Yi?[e]:e instanceof zi?e.data:Pi(e).data;var e})));if(ArrayBuffer.isView(t)){t instanceof DataView&&(t=new Uint8Array(t.buffer));const e={offset:0,length:t.length,nullCount:-1,data:t};if(t instanceof Int8Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new ht}))]);if(t instanceof Int16Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new pt}))]);if(t instanceof Int32Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new yt}))]);if(t instanceof BigInt64Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new dt}))]);if(t instanceof Uint8Array||t instanceof Uint8ClampedArray)return new zi([Wi(Object.assign(Object.assign({},e),{type:new ft}))]);if(t instanceof Uint16Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new gt}))]);if(t instanceof Uint32Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new mt}))]);if(t instanceof BigUint64Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new vt}))]);if(t instanceof Float32Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new wt}))]);if(t instanceof Float64Array)return new zi([Wi(Object.assign(Object.assign({},e),{type:new St}))]);throw new Error("Unrecognized input")}}throw new Error("Unrecognized input")}class Yi{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(0!==this._nullCount){const{type:t}=this;return lt.isSparseUnion(t)||lt.isDenseUnion(t)?this.children.some((t=>t.nullable)):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0;const{valueOffsets:e,values:i,nullBitmap:n,typeIds:r}=this;return e&&(t+=e.byteLength),i&&(t+=i.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){if(lt.isUnion(this.type))return this.children.reduce(((t,e)=>t+e.nullCount),0);let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=0===t.length?0:this.length-Bi(t,this.offset,this.offset+this.length)),e}constructor(t,e,i,n,r,s=[],o){let a;this.type=t,this.children=s,this.dictionary=o,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1)),r instanceof Yi?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=Vt(t),r&&((a=r[0])&&(this.valueOffsets=a),(a=r[1])&&(this.values=a),(a=r[2])&&(this.nullBitmap=a),(a=r[3])&&(this.typeIds=a)))}getValid(t){const{type:e}=this;if(lt.isUnion(e)){const i=e,n=this.children[i.typeIdToChildIndex[this.typeIds[t]]],r=i.mode===G.Dense?this.valueOffsets[t]:t;return n.getValid(r)}if(this.nullable&&this.nullCount>0){const e=this.offset+t;return!!(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){let i;const{type:n}=this;if(lt.isUnion(n)){const r=n,s=this.children[r.typeIdToChildIndex[this.typeIds[t]]],o=r.mode===G.Dense?this.valueOffsets[t]:t;i=s.getValid(o),s.setValid(o,e)}else{let{nullBitmap:n}=this;const{offset:r,length:s}=this,o=r+t,a=1<<o%8,l=o>>3;(!n||n.byteLength<=l)&&(n=new Uint8Array((r+s+63&-64)>>3).fill(255),this.nullCount>0?(n.set(_i(r,s,this.nullBitmap),0),Object.assign(this,{nullBitmap:n})):Object.assign(this,{nullBitmap:n,_nullCount:0}));const u=n[l];i=!!(u&a),n[l]=e?u|a:u&~a}return i!==!!e&&(this._nullCount=this.nullCount+(e?-1:1)),e}clone(t=this.type,e=this.offset,i=this.length,n=this._nullCount,r=this,s=this.children){return new Yi(t,e,i,n,r,s,this.dictionary)}slice(t,e){const{stride:i,typeId:n,children:r}=this,s=+(0===this._nullCount)-1,o=16===n?i:1,a=this._sliceBuffers(t,e,i,n);return this.clone(this.type,this.offset+t,e,s,a,0===r.length||this.valueOffsets?r:this._sliceChildren(r,o*t,o*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===b.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:i}=this,n=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);n[e>>3]=(1<<e-(-8&e))-1,i>0&&n.set(_i(this.offset,e,this.nullBitmap),0);const r=this.buffers;return r[w.VALIDITY]=n,this.clone(this.type,0,t,i+(t-e),r)}_sliceBuffers(t,e,i,n){let r;const{buffers:s}=this;return(r=s[w.TYPE])&&(s[w.TYPE]=r.subarray(t,t+e)),(r=s[w.OFFSET])&&(s[w.OFFSET]=r.subarray(t,t+e+1))||(r=s[w.DATA])&&(s[w.DATA]=6===n?r:r.subarray(i*t,i*(t+e))),s}_sliceChildren(t,e,i){return t.map((t=>t.slice(e,i)))}}Yi.prototype.children=Object.freeze([]);class Hi extends Pt{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:i=0,length:n=0}=t;return new Yi(e,i,n,n)}visitBool(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length>>3,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitInt(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitFloat(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitUtf8(t){const{type:e,offset:i=0}=t,n=x(t.data),r=x(t.nullBitmap),s=C(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,n,r])}visitLargeUtf8(t){const{type:e,offset:i=0}=t,n=x(t.data),r=x(t.nullBitmap),s=U(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,n,r])}visitBinary(t){const{type:e,offset:i=0}=t,n=x(t.data),r=x(t.nullBitmap),s=C(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,n,r])}visitLargeBinary(t){const{type:e,offset:i=0}=t,n=x(t.data),r=x(t.nullBitmap),s=U(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,n,r])}visitFixedSizeBinary(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitDate(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitTimestamp(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitTime(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitDecimal(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitList(t){const{type:e,offset:i=0,child:n}=t,r=x(t.nullBitmap),s=C(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,void 0,r],[n])}visitStruct(t){const{type:e,offset:i=0,children:n=[]}=t,r=x(t.nullBitmap),{length:s=n.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,void 0,r],n)}visitUnion(t){const{type:e,offset:i=0,children:n=[]}=t,r=M(e.ArrayType,t.typeIds),{length:s=r.length,nullCount:o=-1}=t;if(lt.isSparseUnion(e))return new Yi(e,i,s,o,[void 0,void 0,void 0,r],n);const a=C(t.valueOffsets);return new Yi(e,i,s,o,[a,void 0,void 0,r],n)}visitDictionary(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.indices.ArrayType,t.data),{dictionary:s=new zi([(new Hi).visit({type:e.dictionary})])}=t,{length:o=r.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[void 0,r,n],[],s)}visitInterval(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitDuration(t){const{type:e,offset:i=0}=t,n=x(t.nullBitmap),r=M(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,r,n])}visitFixedSizeList(t){const{type:e,offset:i=0,child:n=(new Hi).visit({type:e.valueType})}=t,r=x(t.nullBitmap),{length:s=n.length/Vt(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,s,o,[void 0,void 0,r],[n])}visitMap(t){const{type:e,offset:i=0,child:n=(new Hi).visit({type:e.childType})}=t,r=x(t.nullBitmap),s=C(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Yi(e,i,o,a,[s,void 0,r],[n])}}const qi=new Hi;function Wi(t){return qi.visit(t)}var Ji;!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Ji||(Ji={}));class Gi{constructor(t=[],e,i,n=Ji.V5){this.fields=t||[],this.metadata=e||new Map,i||(i=Zi(this.fields)),this.dictionaries=i,this.metadataVersion=n}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),i=this.fields.filter((t=>e.has(t.name)));return new Gi(i,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new Gi(e,this.metadata)}assign(...t){const e=t[0]instanceof Gi?t[0]:Array.isArray(t[0])?new Gi(t[0]):new Gi(t),i=[...this.fields],n=Qi(Qi(new Map,this.metadata),e.metadata),r=e.fields.filter((t=>{const e=i.findIndex((e=>e.name===t.name));return!~e||(i[e]=t.clone({metadata:Qi(Qi(new Map,i[e].metadata),t.metadata)}))&&!1})),s=Zi(r,new Map);return new Gi([...i,...r],n,new Map([...this.dictionaries,...s]))}}Gi.prototype.fields=null,Gi.prototype.metadata=null,Gi.prototype.dictionaries=null;class Ki{static new(...t){let[e,i,n,r]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===i&&(i=t[0].type),void 0===n&&(n=t[0].nullable),void 0===r&&(r=t[0].metadata)),new Ki(`${e}`,i,n,r)}constructor(t,e,i=!1,n){this.name=t,this.type=e,this.nullable=i,this.metadata=n||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,i,n,r]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:i=this.type,nullable:n=this.nullable,metadata:r=this.metadata}=t[0]):[e=this.name,i=this.type,n=this.nullable,r=this.metadata]=t,Ki.new(e,i,n,r)}}function Qi(t,e){return new Map([...t||new Map,...e||new Map])}function Zi(t,e=new Map){for(let i=-1,n=t.length;++i<n;){const n=t[i].type;if(lt.isDictionary(n))if(e.has(n.id)){if(e.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(n.id,n.dictionary);n.children&&n.children.length>0&&Zi(n.children,e)}return e}Ki.prototype.type=null,Ki.prototype.name=null,Ki.prototype.nullable=null,Ki.prototype.metadata=null;class Xi extends Pt{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,i)=>this.compareFields(t,e[i])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function tn(t,e){return e instanceof t.constructor}function en(t,e){return t===e||tn(t,e)}function nn(t,e){return t===e||tn(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function rn(t,e){return t===e||tn(t,e)&&t.precision===e.precision}function sn(t,e){return t===e||tn(t,e)&&t.unit===e.unit}function on(t,e){return t===e||tn(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function an(t,e){return t===e||tn(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function ln(t,e){return t===e||tn(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,i)=>t===e.typeIds[i]))&&hn.compareManyFields(t.children,e.children)}function un(t,e){return t===e||tn(t,e)&&t.unit===e.unit}function cn(t,e){return t===e||tn(t,e)&&t.unit===e.unit}Xi.prototype.visitNull=en,Xi.prototype.visitBool=en,Xi.prototype.visitInt=nn,Xi.prototype.visitInt8=nn,Xi.prototype.visitInt16=nn,Xi.prototype.visitInt32=nn,Xi.prototype.visitInt64=nn,Xi.prototype.visitUint8=nn,Xi.prototype.visitUint16=nn,Xi.prototype.visitUint32=nn,Xi.prototype.visitUint64=nn,Xi.prototype.visitFloat=rn,Xi.prototype.visitFloat16=rn,Xi.prototype.visitFloat32=rn,Xi.prototype.visitFloat64=rn,Xi.prototype.visitUtf8=en,Xi.prototype.visitLargeUtf8=en,Xi.prototype.visitBinary=en,Xi.prototype.visitLargeBinary=en,Xi.prototype.visitFixedSizeBinary=function(t,e){return t===e||tn(t,e)&&t.byteWidth===e.byteWidth},Xi.prototype.visitDate=sn,Xi.prototype.visitDateDay=sn,Xi.prototype.visitDateMillisecond=sn,Xi.prototype.visitTimestamp=on,Xi.prototype.visitTimestampSecond=on,Xi.prototype.visitTimestampMillisecond=on,Xi.prototype.visitTimestampMicrosecond=on,Xi.prototype.visitTimestampNanosecond=on,Xi.prototype.visitTime=an,Xi.prototype.visitTimeSecond=an,Xi.prototype.visitTimeMillisecond=an,Xi.prototype.visitTimeMicrosecond=an,Xi.prototype.visitTimeNanosecond=an,Xi.prototype.visitDecimal=en,Xi.prototype.visitList=function(t,e){return t===e||tn(t,e)&&t.children.length===e.children.length&&hn.compareManyFields(t.children,e.children)},Xi.prototype.visitStruct=function(t,e){return t===e||tn(t,e)&&t.children.length===e.children.length&&hn.compareManyFields(t.children,e.children)},Xi.prototype.visitUnion=ln,Xi.prototype.visitDenseUnion=ln,Xi.prototype.visitSparseUnion=ln,Xi.prototype.visitDictionary=function(t,e){return t===e||tn(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&hn.visit(t.indices,e.indices)&&hn.visit(t.dictionary,e.dictionary)},Xi.prototype.visitInterval=un,Xi.prototype.visitIntervalDayTime=un,Xi.prototype.visitIntervalYearMonth=un,Xi.prototype.visitIntervalMonthDayNano=un,Xi.prototype.visitDuration=cn,Xi.prototype.visitDurationSecond=cn,Xi.prototype.visitDurationMillisecond=cn,Xi.prototype.visitDurationMicrosecond=cn,Xi.prototype.visitDurationNanosecond=cn,Xi.prototype.visitFixedSizeList=function(t,e){return t===e||tn(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&hn.compareManyFields(t.children,e.children)},Xi.prototype.visitMap=function(t,e){return t===e||tn(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&hn.compareManyFields(t.children,e.children)};const hn=new Xi;function pn(t,e){return hn.compareSchemas(t,e)}function yn(t,e){return function(t,e){const i=[...t.fields],n=[],r={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let s=0,o=0,a=-1;const l=e.length;let u,c=[];for(;r.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<l;)c[a]=u=e[a].shift(),o=Math.min(o,u?u.length:o);Number.isFinite(o)&&(c=dn(i,o,c,e,r),o>0&&(n[s++]=Wi({type:new Et(i),length:o,nullCount:0,children:c.slice()})))}return[t=t.assign(i),n.map((e=>new vn(t,e)))]}(t,e.map((t=>t.data.concat())))}function dn(t,e,i,n,r){var s;const o=(e+63&-64)>>3;for(let a=-1,l=n.length;++a<l;){const l=i[a],u=null==l?void 0:l.length;if(u>=e)u===e?i[a]=l:(i[a]=l.slice(0,e),r.numBatches=Math.max(r.numBatches,n[a].unshift(l.slice(e,u-e))));else{const n=t[a];t[a]=n.clone({nullable:!0}),i[a]=null!==(s=null==l?void 0:l._changeLengthAndBackfillNullBitmap(e))&&void 0!==s?s:Wi({type:n.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)})}}return i}var fn,gn;class mn{constructor(...t){var e,i;if(0===t.length)return this.batches=[],this.schema=new Gi([]),this._offsets=[0],this;let n,r;t[0]instanceof Gi&&(n=t.shift()),t.at(-1)instanceof Uint32Array&&(r=t.pop());const s=t=>{if(t){if(t instanceof vn)return[t];if(t instanceof mn)return t.batches;if(t instanceof Yi){if(t.type instanceof Et)return[new vn(new Gi(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>s(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>s(t)));if("object"==typeof t){const e=Object.keys(t),i=e.map((e=>new zi([t[e]]))),r=null!=n?n:new Gi(e.map(((t,e)=>new Ki(String(t),i[e].type,i[e].nullable)))),[,s]=yn(r,i);return 0===s.length?[new vn(t)]:s}}}return[]},o=t.flatMap((t=>s(t)));if(n=null!==(i=null!=n?n:null===(e=o[0])||void 0===e?void 0:e.schema)&&void 0!==i?i:new Gi([]),!(n instanceof Gi))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const a of o){if(!(a instanceof vn))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!pn(n,a.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=o,this._offsets=null!=r?r:mi(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=gi(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}at(t){return this.get(ci(t,this.numRows))}set(t,e){}indexOf(t,e){return-1}[Symbol.iterator](){return this.batches.length>0?ki.visit(new zi(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,i=this.data.concat(t.flatMap((({data:t})=>t)));return new mn(e,i.map((t=>new vn(e,t))))}slice(t,e){const i=this.schema;[t,e]=ui({length:this.numRows},t,e);const n=vi(this.data,this._offsets,t,e);return new mn(i,n.map((t=>new vn(i,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:i}=this.schema.fields[t],n=Wi({type:i,length:0,nullCount:0});e.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new zi(e)}return null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new zi([Wi({type:new ut,length:this.numRows})]));const r=i.fields.slice(),s=r[t].clone({type:e.type}),o=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[r[t],o[t]]=[s,e],[i,n]=yn(i,o)}return new mn(i,n)}select(t){const e=this.schema.fields.reduce(((t,e,i)=>t.set(e.name,i)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),i=this.batches.map((e=>e.selectAt(t)));return new mn(e,i)}assign(t){const e=this.schema.fields,[i,n]=t.schema.fields.reduce(((t,i,n)=>{const[r,s]=t,o=e.findIndex((t=>t.name===i.name));return~o?s[o]=n:r.push(n),t}),[[],[]]),r=this.schema.assign(t.schema),s=[...e.map(((t,e)=>[e,n[e]])).map((([e,i])=>void 0===i?this.getChildAt(e):t.getChildAt(i))),...i.map((e=>t.getChildAt(e)))].filter(Boolean);return new mn(...yn(r,s))}}fn=Symbol.toStringTag,mn[fn]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=Si(wi),t.get=Si(ti.getVisitFn(b.Struct)),t.set=Ti(Te.getVisitFn(b.Struct)),t.indexOf=Ii(Ni.getVisitFn(b.Struct)),"Table"))(mn.prototype);class vn{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof Gi))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Wi({nullCount:0,type:new Et(this.schema.fields),children:this.schema.fields.map((t=>Wi({type:t.type,nullCount:0})))})]=t,!(this.data instanceof Yi))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=bn(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:i,children:n,length:r}=Object.keys(e).reduce(((t,i,n)=>(t.children[n]=e[i],t.length=Math.max(t.length,e[i].length),t.fields[n]=Ki.new({name:i,type:e[i].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),s=new Gi(i),o=Wi({type:new Et(i),length:r,children:n,nullCount:0});[this.schema,this.data]=bn(s,o.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=wn(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return ti.visit(this.data,t)}at(t){return this.get(ci(t,this.numRows))}set(t,e){return Te.visit(this.data,t,e)}indexOf(t,e){return Ni.visit(this.data,t,e)}[Symbol.iterator](){return ki.visit(new zi([this.data]))}toArray(){return[...this]}concat(...t){return new mn(this.schema,[this,...t])}slice(t,e){const[i]=new zi([this.data]).slice(t,e).data;return new vn(this.schema,i)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new zi([this.data.children[t]]):null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=this.data;if(t>-1&&t<this.numCols){e||(e=new zi([Wi({type:new ut,length:this.numRows})]));const r=i.fields.slice(),s=n.children.slice(),o=r[t].clone({type:e.type});[r[t],s[t]]=[o,e.data[0]],i=new Gi(r,new Map(this.schema.metadata)),n=Wi({type:new Et(r),children:s})}return new vn(i,n)}select(t){const e=this.schema.select(t),i=new Et(e.fields),n=[];for(const r of t){const t=this.schema.fields.findIndex((t=>t.name===r));~t&&(n[t]=this.data.children[t])}return new vn(e,Wi({type:i,length:this.numRows,children:n}))}selectAt(t){const e=this.schema.selectAt(t),i=t.map((t=>this.data.children[t])).filter(Boolean),n=Wi({type:new Et(e.fields),length:this.numRows,children:i});return new vn(e,n)}}function bn(t,e,i=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var n;const r=[...t.fields],s=[...e],o=(i+63&-64)>>3;for(const[a,l]of t.fields.entries()){const t=e[a];t&&t.length===i||(r[a]=l.clone({nullable:!0}),s[a]=null!==(n=null==t?void 0:t._changeLengthAndBackfillNullBitmap(i))&&void 0!==n?n:Wi({type:l.type,length:i,nullCount:i,nullBitmap:new Uint8Array(o)}))}return[t.assign(r),Wi({type:new Et(r),length:i,children:s})]}function wn(t,e,i=new Map){var n,r;if((null!==(n=null==t?void 0:t.length)&&void 0!==n?n:0)>0&&(null==t?void 0:t.length)===(null==e?void 0:e.length))for(let s=-1,o=t.length;++s<o;){const{type:n}=t[s],o=e[s];for(const t of[o,...(null===(r=null==o?void 0:o.dictionary)||void 0===r?void 0:r.data)||[]])wn(n.children,null==t?void 0:t.children,i);if(lt.isDictionary(n)){const{id:t}=n;if(i.has(t)){if(i.get(t)!==o.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else(null==o?void 0:o.dictionary)&&i.set(t,o.dictionary)}}return i}gn=Symbol.toStringTag,vn[gn]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(vn.prototype);class Sn extends v{arrowSchema;constructor(t,e){super(t,e),this.arrowSchema=null}getBatch(){const t=super.getBatch();if(t){this.arrowSchema=this.arrowSchema||function(t){const e=[];for(const i in t){const n=t[i];if(n.type===Float32Array){const t=new Map,i=new Ki(n.name,new wt,n.nullable,t);e.push(i)}}if(0===e.length)throw new Error("No arrow convertible fields");return new Gi(e)}(t.schema);const e=function(t,e){const i=[];for(const n of t.fields){const t=e[n.name];if(t instanceof Float32Array){const e=Pi(t);i.push(e)}}if(t.fields.length!==i.length)throw new Error("Some columns not arrow convertible");return i}(this.arrowSchema,t.data),i=new vn(this.arrowSchema,Wi({type:new Et(this.arrowSchema.fields),children:e.map((({data:t})=>t[0]))}));return{shape:"arrow-table",batchType:"data",data:new mn([i]),length:t.length}}return null}}const Tn={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0};class In{schema;options;aggregator=null;batchCount=0;bytesUsed=0;isChunkComplete=!1;lastBatchEmittedMs=Date.now();totalLength=0;totalBytes=0;rowBytes=0;static ArrowBatch;constructor(t,e){this.schema=t,this.options={...Tn,...e}}limitReached(){return!!(Boolean(this.options?.limit)&&this.totalLength>=this.options.limit)||!!(Boolean(this.options?._limitMB)&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){const t=this._getTableBatchType();this.aggregator=new t(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),"string"==typeof t&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?8*t.length:8*Object.keys(t).length}_isFull(){if(!this.aggregator||0===this.aggregator.rowCount())return!1;if("auto"===this.options.batchSize){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return!(this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs)&&(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(t){if(!this.aggregator)return null;t?.bytesUsed&&(this.bytesUsed=t.bytesUsed);const e=this.aggregator.getBatch();return e.count=this.batchCount,e.bytesUsed=this.bytesUsed,Object.assign(e,t),this.batchCount++,this.aggregator=null,e}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return g;case"columnar-table":return v;case"arrow-table":return Sn;default:return f}}}const An={RECORD_SEP:String.fromCharCode(30),UNIT_SEP:String.fromCharCode(31),BYTE_ORDER_MARK:"\ufeff",BAD_DELIMITERS:["\r","\n",'"',"\ufeff"],WORKERS_SUPPORTED:!1,NODE_STREAM_INPUT:1,LocalChunkSize:10485760,RemoteChunkSize:5242880,DefaultDelimiter:","};class Dn{_handle;_config;_finished=!1;_completed=!1;_input=null;_baseIndex=0;_partialLine="";_rowCount=0;_start=0;isFirstChunk=!0;_completeResults={data:[],errors:[],meta:{}};constructor(t){const e={...t};e.dynamicTypingFunction&&(e.dynamicTyping={}),e.chunkSize=parseInt(e.chunkSize),t.step||t.chunk||(e.chunkSize=null),this._handle=new Mn(e),this._handle.streamer=this,this._config=e}parseChunk(t,e){if(this.isFirstChunk&&Nn(this._config.beforeFirstChunk)){const e=this._config.beforeFirstChunk(t);void 0!==e&&(t=e)}this.isFirstChunk=!1;const i=this._partialLine+t;this._partialLine="";let n=this._handle.parse(i,this._baseIndex,!this._finished);if(this._handle.paused()||this._handle.aborted())return;const r=n.meta.cursor;this._finished||(this._partialLine=i.substring(r-this._baseIndex),this._baseIndex=r),n&&n.data&&(this._rowCount+=n.data.length);const s=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(Nn(this._config.chunk)&&!e){if(this._config.chunk(n,this._handle),this._handle.paused()||this._handle.aborted())return;n=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(n.data),this._completeResults.errors=this._completeResults.errors.concat(n.errors),this._completeResults.meta=n.meta),this._completed||!s||!Nn(this._config.complete)||n&&n.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),n}_sendError(t){Nn(this._config.error)&&this._config.error(t)}}class _n extends Dn{remaining;constructor(t={}){super(t)}stream(t){return this.remaining=t,this._nextChunk()}_nextChunk(){if(this._finished)return;const t=this._config.chunkSize,e=t?this.remaining.substr(0,t):this.remaining;return this.remaining=t?this.remaining.substr(t):"",this._finished=!this.remaining,this.parseChunk(e)}}const On=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,Bn=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/;class Mn{_config;_stepCounter=0;_rowCounter=0;_input;_parser;_paused=!1;_aborted=!1;_delimiterError=!1;_fields=[];_results={data:[],errors:[],meta:{}};constructor(t){if(Nn(t.step)){const e=t.step;t.step=i=>{if(this._results=i,this.needsHeaderRow())this.processResults();else{if(this.processResults(),!this._results.data||0===this._results.data.length)return;this._stepCounter+=i.data.length,t.preview&&this._stepCounter>t.preview?this._parser.abort():e(this._results,this)}}}this._config=t}parse(t,e,i){const n=this._config.quoteChar||'"';if(this._config.newline||(this._config.newline=function(t,e){t=t.substr(0,1048576);const i=new RegExp(`${Cn(e)}([^]*?)${Cn(e)}`,"gm");t=t.replace(i,"");const n=t.split("\r"),r=t.split("\n"),s=r.length>1&&r[0].length<n[0].length;if(1===n.length||s)return"\n";let o=0;for(let a=0;a<n.length;a++)"\n"===n[a][0]&&o++;return o>=n.length/2?"\r\n":"\r"}(t,n)),this._delimiterError=!1,this._config.delimiter)Nn(this._config.delimiter)&&(this._config.delimiter=this._config.delimiter(t),this._results.meta.delimiter=this._config.delimiter);else{const e=this.guessDelimiter(t,this._config.newline,this._config.skipEmptyLines,this._config.comments,this._config.delimitersToGuess);e.successful?this._config.delimiter=e.bestDelimiter:(this._delimiterError=!0,this._config.delimiter=An.DefaultDelimiter),this._results.meta.delimiter=this._config.delimiter}const r=xn(this._config);return this._config.preview&&this._config.header&&r.preview++,this._input=t,this._parser=new Un(r),this._results=this._parser.parse(this._input,e,i),this.processResults(),this._paused?{meta:{paused:!0}}:this._results||{meta:{paused:!1}}}paused(){return this._paused}pause(){this._paused=!0,this._parser.abort(),this._input=this._input.substr(this._parser.getCharIndex())}resume(){this._paused=!1,this.streamer.parseChunk(this._input,!0)}aborted(){return this._aborted}abort(){this._aborted=!0,this._parser.abort(),this._results.meta.aborted=!0,Nn(this._config.complete)&&this._config.complete(this._results),this._input=""}testEmptyLine(t){return"greedy"===this._config.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}processResults(){if(this._results&&this._delimiterError&&(this.addError("Delimiter","UndetectableDelimiter",`Unable to auto-detect delimiting character; defaulted to '${An.DefaultDelimiter}'`),this._delimiterError=!1),this._config.skipEmptyLines)for(let t=0;t<this._results.data.length;t++)this.testEmptyLine(this._results.data[t])&&this._results.data.splice(t--,1);return this.needsHeaderRow()&&this.fillHeaderFields(),this.applyHeaderAndDynamicTypingAndTransformation()}needsHeaderRow(){return this._config.header&&0===this._fields.length}fillHeaderFields(){if(!this._results)return;const t=t=>{Nn(this._config.transformHeader)&&(t=this._config.transformHeader(t)),this._fields.push(t)};if(Array.isArray(this._results.data[0])){for(let e=0;this.needsHeaderRow()&&e<this._results.data.length;e++)this._results.data[e].forEach(t);this._results.data.splice(0,1)}else this._results.data.forEach(t)}shouldApplyDynamicTyping(t){return this._config.dynamicTypingFunction&&void 0===this._config.dynamicTyping?.[t]&&(this._config.dynamicTyping[t]=this._config.dynamicTypingFunction(t)),!0===(this._config.dynamicTyping?.[t]||this._config.dynamicTyping)}parseDynamic(t,e){return this.shouldApplyDynamicTyping(t)?"true"===e||"TRUE"===e||"false"!==e&&"FALSE"!==e&&(On.test(e)?parseFloat(e):Bn.test(e)?new Date(e):""===e?null:e):e}applyHeaderAndDynamicTypingAndTransformation(){if(!this._results||!this._results.data||!this._config.header&&!this._config.dynamicTyping&&!this._config.transform)return this._results;let t=1;return!this._results.data[0]||Array.isArray(this._results.data[0])?(this._results.data=this._results.data.map(this.processRow.bind(this)),t=this._results.data.length):this._results.data=this.processRow(this._results.data,0),this._config.header&&this._results.meta&&(this._results.meta.fields=this._fields),this._rowCounter+=t,this._results}processRow(t,e){const i=this._config.header?{}:[];let n;for(n=0;n<t.length;n++){let e=n,r=t[n];this._config.header&&(e=n>=this._fields.length?"__parsed_extra":this._fields[n]),this._config.transform&&(r=this._config.transform(r,e)),r=this.parseDynamic(e,r),"__parsed_extra"===e?(i[e]=i[e]||[],i[e].push(r)):i[e]=r}return this._config.header&&(n>this._fields.length?this.addError("FieldMismatch","TooManyFields",`Too many fields: expected ${this._fields.length} fields but parsed ${n}`,this._rowCounter+e):n<this._fields.length&&this.addError("FieldMismatch","TooFewFields",`Too few fields: expected ${this._fields.length} fields but parsed ${n}`,this._rowCounter+e)),i}guessDelimiter(t,e,i,n,r){let s,o,a;r=r||[",","\t","|",";",An.RECORD_SEP,An.UNIT_SEP];for(let l=0;l<r.length;l++){const u=r[l];let c=0,h=0,p=0;a=void 0;const y=new Un({comments:n,delimiter:u,newline:e,preview:10}).parse(t);for(let t=0;t<y.data.length;t++){if(i&&this.testEmptyLine(y.data[t])){p++;continue}const e=y.data[t].length;c+=e,void 0!==a?e>1&&(h+=Math.abs(e-a),a=e):a=0}y.data.length>0&&(c/=y.data.length-p),(void 0===o||h>o)&&c>1.99&&(o=h,s=u)}return this._config.delimiter=s,{successful:Boolean(s),bestDelimiter:s}}addError(t,e,i,n){this._results.errors.push({type:t,code:e,message:i,row:n})}}function Cn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Un(t={}){let e=t.delimiter,i=t.newline,n=t.comments;const r=t.step,s=t.preview,o=t.fastMode;let a;a=void 0===t.quoteChar?'"':t.quoteChar;let l=a;if(void 0!==t.escapeChar&&(l=t.escapeChar),("string"!=typeof e||An.BAD_DELIMITERS.indexOf(e)>-1)&&(e=","),n===e)throw new Error("Comment character same as delimiter");!0===n?n="#":("string"!=typeof n||An.BAD_DELIMITERS.indexOf(n)>-1)&&(n=!1),"\n"!==i&&"\r"!==i&&"\r\n"!==i&&(i="\n");let u=0,c=!1;this.parse=function(t,h,p){if("string"!=typeof t)throw new Error("Input must be a string");const y=t.length,d=e.length,f=i.length,g=n.length,m=Nn(r);u=0;let v=[],b=[],w=[],S=0;if(!t)return C();if(o||!1!==o&&-1===t.indexOf(a)){const r=t.split(i);for(let t=0;t<r.length;t++){const o=r[t];if(u+=o.length,t!==r.length-1)u+=i.length;else if(p)return C();if(!n||o.substr(0,g)!==n){if(m){if(v=[],_(o.split(e)),U(),c)return C()}else _(o.split(e));if(s&&t>=s)return v=v.slice(0,s),C(!0)}}return C()}let T=t.indexOf(e,u),I=t.indexOf(i,u);const A=new RegExp(Cn(l)+Cn(a),"g");let D;for(;;)if(t[u]!==a)if(n&&0===w.length&&t.substr(u,g)===n){if(-1===I)return C();u=I+f,I=t.indexOf(i,u),T=t.indexOf(e,u)}else if(-1!==T&&(T<I||-1===I))w.push(t.substring(u,T)),u=T+d,T=t.indexOf(e,u);else{if(-1===I)break;if(w.push(t.substring(u,I)),M(I+f),m&&(U(),c))return C();if(s&&v.length>=s)return C(!0)}else{for(D=u,u++;;){if(D=t.indexOf(a,D+1),-1===D)return p||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:v.length,index:u}),B();if(D===y-1){return B(t.substring(u,D).replace(A,a))}if(a===l&&t[D+1]===l){D++;continue}if(a!==l&&0!==D&&t[D-1]===l)continue;const n=O(-1===I?T:Math.min(T,I));if(t[D+1+n]===e){if(w.push(t.substring(u,D).replace(A,a)),u=D+1+n+d,T=t.indexOf(e,u),I=t.indexOf(i,u),m&&(U(),c))return C();if(s&&v.length>=s)return C(!0);break}const r=O(I);if(t.substr(D+1+r,f)===i){if(w.push(t.substring(u,D).replace(A,a)),M(D+1+r+f),T=t.indexOf(e,u),m&&(U(),c))return C();if(s&&v.length>=s)return C(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:v.length,index:u}),D++}if(m&&(U(),c))return C();if(s&&v.length>=s)return C(!0)}return B();function _(t){v.push(t),S=u}function O(e){let i=0;if(-1!==e){const n=t.substring(D+1,e);n&&""===n.trim()&&(i=n.length)}return i}function B(e){return p||(void 0===e&&(e=t.substr(u)),w.push(e),u=y,_(w),m&&U()),C()}function M(e){u=e,_(w),w=[],I=t.indexOf(i,u)}function C(t,n){return{data:n||!1?v[0]:v,errors:b,meta:{delimiter:e,linebreak:i,aborted:c,truncated:Boolean(t),cursor:S+(h||0)}}}function U(){r(C(void 0,!0)),v=[],b=[]}},this.abort=function(){c=!0},this.getCharIndex=function(){return u}}function xn(t){if("object"!=typeof t||null===t)return t;const e=Array.isArray(t)?[]:{};for(const i in t)e[i]=xn(t[i]);return e}function Nn(t){return"function"==typeof t}const En={...An,parse:function(t,e={},i=_n){return new i(e).stream(t)},unparse:function(t,e={}){let i=!1,n=!0,r=",",s="\r\n",o='"',a=o+o,l=!1,u=null;!function(){if("object"!=typeof e)return;"string"!=typeof e.delimiter||An.BAD_DELIMITERS.filter((function(t){return-1!==e.delimiter?.indexOf(t)})).length||(r=e.delimiter);("boolean"==typeof e.quotes||Array.isArray(e.quotes))&&(i=e.quotes);"boolean"!=typeof e.skipEmptyLines&&"greedy"!==e.skipEmptyLines||(l=e.skipEmptyLines);"string"==typeof e.newline&&(s=e.newline);"string"==typeof e.quoteChar&&(o=e.quoteChar);"boolean"==typeof e.header&&(n=e.header);if(Array.isArray(e.columns)){if(0===e.columns.length)throw new Error("Option columns is empty");u=e.columns}void 0!==e.escapeChar&&(a=e.escapeChar+o)}();const c=new RegExp(o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g");if("string"==typeof t&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return h(null,t,l);if("object"==typeof t[0])return h(u||Object.keys(t[0]),t,l)}else if("object"==typeof t)return"string"==typeof t.data&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:Object.keys(t.data[0])),Array.isArray(t.data[0])||"object"==typeof t.data[0]||(t.data=[t.data])),h(t.fields||[],t.data||[],l);throw new Error("Unable to serialize unrecognized input");function h(t,e,i){let o="";"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e));const a=Array.isArray(t)&&t.length>0,l=!Array.isArray(e[0]);if(a&&n){for(let e=0;e<t.length;e++)e>0&&(o+=r),o+=p(t[e],e);e.length>0&&(o+=s)}for(let n=0;n<e.length;n++){const u=a?t.length:e[n].length;let c=!1;const h=a?0===Object.keys(e[n]).length:0===e[n].length;if(i&&!a&&(c="greedy"===i?""===e[n].join("").trim():1===e[n].length&&0===e[n][0].length),"greedy"===i&&a){const i=[];for(let r=0;r<u;r++){const s=l?t[r]:r;i.push(e[n][s])}c=""===i.join("").trim()}if(!c){for(let i=0;i<u;i++){i>0&&!h&&(o+=r);const s=a&&l?t[i]:i;o+=p(e[n][s],i)}n<e.length-1&&(!i||u>0&&!h)&&(o+=s)}}return o}function p(t,e){if(null==t)return"";if(t.constructor===Date)return JSON.stringify(t).slice(1,25);t=t.toString().replace(c,a);const n="boolean"==typeof i&&i||Array.isArray(i)&&i[e]||function(t,e){for(let i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1}(t,An.BAD_DELIMITERS)||t.indexOf(r)>-1||" "===t.charAt(0)||" "===t.charAt(t.length-1);return n?o+t+o:t}},ChunkStreamer:Dn,Parser:Un,ParserHandle:Mn},{ChunkStreamer:Fn}=En;class Ln extends Fn{textDecoder=new TextDecoder(this._config.encoding);constructor(t={}){super(t)}async stream(t){this._input=t;try{for await(const e of t)this.parseChunk(this.getStringChunk(e));this._finished=!0,this.parseChunk("")}catch(e){this._sendError(e)}}_nextChunk(){}getStringChunk(t){return"string"==typeof t?t:this.textDecoder.decode(t,{stream:!0})}}const kn="object-row-table",jn={id:"csv",module:"csv",name:"CSV",extensions:["csv","tsv","dsv"],mimeTypes:["text/csv","text/tab-separated-values","text/dsv"],category:"table",dataType:null,batchType:null,version:"4.4.0-alpha.14",parse:async(t,e)=>Rn((new TextDecoder).decode(t),e),parseText:(t,e)=>Rn(t,e),parseInBatches:function(t,e){e={...e},"auto"===e?.core?.batchSize&&(e.core.batchSize=4e3);const i={...jn.options.csv,...e?.csv},s=new d;let o=!0,a=null,l=null,u=null;const c={...i,header:!1,download:!1,chunkSize:5242880,skipEmptyLines:!1,step(t){let n=t.data;if(i.skipEmptyLines){if(""===n.flat().join("").trim())return}const c=t.meta.cursor;if(o&&!a){if("auto"===i.header?$n(n):Boolean(i.header))return void(a=n.map(zn()))}o&&(o=!1,a||(a=Vn(i.columnPrefix,n.length)),u=function(t,e){const i=[];for(let n=0;n<t.length;n++){const s=e&&e[n]||n,o=t[n];switch(typeof o){case"number":i.push({name:String(s),type:"float64",nullable:!0});break;case"boolean":i.push({name:String(s),type:"bool",nullable:!0});break;case"string":i.push({name:String(s),type:"utf8",nullable:!0});break;default:r.R.warn("CSV: Unknown column type: "+typeof o)(),i.push({name:String(s),type:"utf8",nullable:!0})}}return{fields:i,metadata:{"loaders.gl#format":"csv","loaders.gl#loader":"CSVLoader"}}}(n,a)),i.optimizeMemoryUsage&&(n=JSON.parse(JSON.stringify(n)));const h=e?.shape||i.shape||kn;l=l||new In(u,{shape:h,...e?.core||{}});try{l.addRow(n);const t=l&&l.getFullBatch({bytesUsed:c});t&&s.enqueue(t)}catch(p){s.enqueue(p)}},complete(t){try{const e=t.meta.cursor,i=l&&l.getFinalBatch({bytesUsed:e});i&&s.enqueue(i)}catch(e){s.enqueue(e)}s.close()}};return En.parse((0,n.Pb)(t),c,Ln),s},options:{csv:{shape:kn,optimizeMemoryUsage:!1,header:"auto",columnPrefix:"column",quoteChar:'"',escapeChar:'"',dynamicTyping:!0,comments:!1,skipEmptyLines:!0,delimitersToGuess:[",","\t","|",";"]}}};async function Rn(t,e){const i={...jn.options.csv,...e?.csv},n=function(t){const e=En.parse(t,{dynamicTyping:!0,preview:1});return e.data[0]}(t),r="auto"===i.header?$n(n):Boolean(i.header),a={...i,header:r,download:!1,transformHeader:r?zn():void 0,error:t=>{throw new Error(t)}},u=En.parse(t,a),c=u.data,h=u.meta.fields||Vn(i.columnPrefix,n.length),p=i.shape||kn;let y;switch(p){case"object-row-table":y={shape:"object-row-table",data:c.map((t=>Array.isArray(t)?s(t,h):t))};break;case"array-row-table":y={shape:"array-row-table",data:c.map((t=>Array.isArray(t)?t:o(t,h)))};break;default:throw new Error(p)}return y.schema=l(y),y}function $n(t){return t&&t.every((t=>"string"==typeof t))}function zn(){const t=new Set;return e=>{let i=e,n=1;for(;t.has(i);)i=`${e}.${n}`,n++;return t.add(i),i}}function Vn(t,e=0){const i=[];for(let n=0;n<e;n++)i.push(`${t}${n+1}`);return i}}}]);